//import database connection
const pool = require('../data/database.js');

exports.posts = async function(req, res) {
    try {
        console.log("get posts request has arrived");
        const posts = await pool.query(
        "SELECT * FROM public.postitused"
        );
        res.render('posts', { posts: posts.rows });
        } catch (err) {
        console.error(err.message);
        }
};

exports.singlepost = async function(req, res) {
    try {
        const id = req.params.id;
        console.log(id);
        console.log("get singlepost request has arrived");
        const singlepost = await pool.query(
        "SELECT * FROM public.postitused where id = $1", [id]);
        res.render('singlepost', { post: singlepost.rows[0] });
        } catch (err) {
        console.error(err.message);
        }
};

exports.postdelete = async function(req, res) {
    try {
        console.log("delete p√§ringu parameetrid");
        console.log(req.params);
        const { id } = req.params;
        const post = req.body;
        console.log("delete a post request has arrived");
        const deletepost = await pool.query(
        "DELETE FROM public.postitused WHERE id = $1", [id]);
        res.redirect('/posts');
        } catch (err) {
        console.error(err.message);
        }
};





